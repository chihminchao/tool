#!/bin/bash
#set -x

#I assume 
#   the wrapper command format is  "arm-command", 
#   the origin toolchain name is "arm-what-ever-you-want-gcc
#   the gcc must exist 

toolname=`echo ${0##/*/} | cut -d '-' -f 2`;
toolarch=`echo ${0##/*/} | cut -d '-' -f 1`;
tooltype=`ls $ARM_TOOLPATH/bin/${toolarch}-*-gcc | head -1`

if [[ -z $toolname ]]; then
	echo "Unknown ARM tool";
fi

if [[ x"$toolarch" != x"arm" ]] && [[ x"$toolarch" != x"aarch64" ]]; then
    echo "Unknown ARM arch  (arm/aarch64)";
	exit 1;
fi

if [[ -z $ARM_TOOLPATH ]]; then
	echo '$ARM_TOOLPATH' is not set;
	exit 1;
fi

if [[ ! -e $tooltype ]]; then
	echo "Can't find tooltype";
	exit 1;
fi

toolprefix=${tooltype##*/}
toolprefix=${toolprefix%-gcc}

realtool="$ARM_TOOLPATH/bin/${toolprefix}-$toolname";


if [ ! -x $realtool ]; then
	"file is not executable"
	exit 1;
fi

$realtool $*
